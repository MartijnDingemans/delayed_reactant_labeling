<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<title>Predict</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
<style type="text/css">

/*
*   math2html: convert LaTeX equations to HTML output.
*
*   Copyright (C) 2009,2010 Alex Fernández
*                 2021      Günter Milde
*
*   Released under the terms of the `2-Clause BSD license'_, in short:
*   Copying and distribution of this file, with or without modification,
*   are permitted in any medium without royalty provided the copyright
*   notice and this notice are preserved.
*   This file is offered as-is, without any warranty.
*
* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
*
*   Based on eLyXer: convert LyX source files to HTML output.
*   http://elyxer.nongnu.org/
*
*
* CSS file for LaTeX formulas.
*
* References: http://www.zipcon.net/~swhite/docs/math/math.html
*             http://www.cs.tut.fi/~jkorpela/math/
*/

/* Formulas */
.formula {
	text-align: center;
	margin: 1.2em 0;
	line-height: 1.4;
}
span.formula {
	white-space: nowrap;
}
div.formula {
	padding: 0.5ex;
	margin-left: auto;
	margin-right: auto;
}

/* Basic features */
a.eqnumber {
	display: inline-block;
	float: right;
	clear: right;
	font-weight: bold;
}
span.unknown {
	color: #800000;
}
span.ignored, span.arraydef {
	display: none;
}
.phantom {
	visibility: hidden;
}
.formula i {
	letter-spacing: 0.1ex;
}

/* Alignment */
.align-left, .align-l {
	text-align: left;
}
.align-right, .align-r {
	text-align: right;
}
.align-center, .align-c {
	text-align: center;
}

/* Structures */
span.hspace {
	display: inline-block;
}
span.overline, span.bar {
	text-decoration: overline;
}
.fraction, .fullfraction, .textfraction {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
}
span.formula .fraction,
.textfraction,
span.smallmatrix {
	font-size: 80%;
	line-height: 1;
}
span.numerator {
	display: block;
	line-height: 1;
}
span.denominator {
	display: block;
	line-height: 1;
	padding: 0ex;
	border-top: thin solid;
}
.formula sub, .formula sup {
	font-size: 80%;
}
sup.numerator, sup.unit {
	vertical-align: 80%;
}
sub.denominator, sub.unit {
	vertical-align: -20%;
}
span.smallsymbol {
	font-size: 75%;
	line-height: 75%;
}
span.boldsymbol {
	font-weight: bold;
}
span.sqrt {
	display: inline-block;
	vertical-align: middle;
	padding: 0.1ex;
}
sup.root {
	position: relative;
	left: 1.4ex;
}
span.radical {
	display: inline-block;
	padding: 0ex;
	/* font-size: 160%; for DejaVu, not required with STIX */
	line-height: 100%;
	vertical-align: top;
	vertical-align: middle;
}

span.root {
	display: inline-block;
	border-top: thin solid;
	padding: 0ex;
	vertical-align: middle;
}
div.formula .bigoperator,
.displaystyle .bigoperator,
.displaystyle .bigoperator {
	line-height: 120%;
	font-size: 140%;
	padding-right: 0.2ex;
}
span.fraction .bigoperator,
span.scriptstyle .bigoperator {
	line-height: inherit;
	font-size: inherit;
	padding-right: 0;
}
span.bigdelimiter {
	display: inline-block;
}
span.bigdelimiter.size1 {
	transform: scale(1, 1.2);
	line-height: 1.2;
}
span.bigdelimiter.size2 {
	transform: scale(1, 1.62);
	line-height: 1.62%;

}
span.bigdelimiter.size3 {
	transform: scale(1, 2.05);
	line-height: 2.05%;
}
span.bigdelimiter.size4 {
	transform: scale(1, 2.47);
	line-height: 2.47%;
}
/* vertically stacked sub and superscript */
span.scripts {
	display: inline-table;
	vertical-align: middle;
	padding-right: 0.2ex;
}
.script {
	display: table-row;
	text-align: left;
	line-height: 150%;
}
span.limits {
	display: inline-table;
	vertical-align: middle;
}
.limit {
	display: table-row;
	line-height: 99%;
}
sup.limit, sub.limit {
	line-height: 100%;
}
span.embellished,
span.embellished > .base {
	display: inline-block;
}
span.embellished > sup,
span.embellished > sub {
	display: inline-block;
	font-size: 100%;
	position: relative;
	bottom: 0.3em;
	width: 0px;
}
span.embellished > sub {
	top: 0.4em;
}

/* Environments */
span.array, span.bracketcases, span.binomial, span.environment {
	display: inline-table;
	text-align: center;
	vertical-align: middle;
}
span.arrayrow, span.binomrow {
	display: table-row;
	padding: 0;
	border: 0;
}
span.arraycell, span.bracket, span.case, span.binomcell, span.environmentcell {
	display: table-cell;
	padding: 0ex 0.2ex;
	line-height: 1; /* 99%; */
	border: 0ex;
}
.environment.align > .arrayrow > .arraycell.align-l {
	padding-right: 2em;
}

/* Inline binomials */
span.binom {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
	font-size: 80%;
}
span.binomstack {
	display: block;
	padding: 0em;
}

/* Over- and underbraces */
span.overbrace {
	border-top: 2pt solid;
}
span.underbrace {
	border-bottom: 2pt solid;
}

/* Stackrel */
span.stackrel {
	display: inline-block;
	text-align: center;
}
span.upstackrel {
	display: block;
	padding: 0em;
	font-size: 80%;
	line-height: 64%;
	position: relative;
	top: 0.15em;

}
span.downstackrel {
	display: block;
	vertical-align: bottom;
	padding: 0em;
}

/* Fonts */
.formula {
	font-family: STIX, "DejaVu Serif", "DejaVu Math TeX Gyre", serif;
}
span.radical,   /* ensure correct size of square-root sign */
span.integral { /* upright integral signs for better alignment of indices */
	font-family: "STIXIntegralsUp", STIX;
	/* font-size: 115%; match apparent size with DejaVu */
}
span.bracket {
  /* some "STIX" and "DejaVu Math TeX Gyre" bracket pieces don't fit */
	font-family: "DejaVu Serif", serif;
}
span.mathsf, span.textsf {
	font-family: sans-serif;
}
span.mathrm, span.textrm {
	font-family: STIX, "DejaVu Serif", "DejaVu Math TeX Gyre", serif;
}
span.mathtt, span.texttt {
	font-family: monospace;
}
span.text, span.textnormal,
span.mathsf, span.mathtt, span.mathrm {
	font-style: normal;
}
span.fraktur {
	font-family: "Lucida Blackletter", eufm10, blackletter;
}
span.blackboard {
	font-family: Blackboard, msbm10, serif;
}
span.scriptfont {
	font-family: "Monotype Corsiva", "Apple Chancery", "URW Chancery L", cursive;
	font-style: italic;
}
span.mathscr {
  font-family: MathJax_Script, rsfs10,  cursive;
  font-style: italic;
}
span.textsc {
	font-variant: small-caps;
}
span.textsl {
	font-style: oblique;
}

/* Colors */
span.colorbox {
	display: inline-block;
	padding: 5px;
}
span.fbox {
	display: inline-block;
	border: thin solid black;
	padding: 2px;
}
span.boxed, span.framebox {
	display: inline-block;
	border: thin solid black;
	padding: 5px;
}

</style>
</head>
<body>
<div class="document" id="predict">
<h1 class="title">Predict</h1>

<p>The predict module implements the <a href="#system-message-1"><span class="problematic" id="problematic-1">:class:`DRL &lt;predict.DRL&gt;`</span></a> class which helps to create a prediction of a chemical
system. When the prediction fails it raises a <a href="#system-message-2"><span class="problematic" id="problematic-2">:exc:`InvalidPredictionError &lt;predict.InvalidPredictionError&gt;`</span></a>. The prediction requires the class
<a href="#system-message-3"><span class="problematic" id="problematic-3">:class:`experimental data &lt;predict.Experimental_Conditions&gt;`</span></a> to contain all relevant data.</p>
<div class="system-message" id="system-message-1">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 3); <em><a href="#problematic-1">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="system-message-2">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 3); <em><a href="#problematic-2">backlink</a></em></p>
Unknown interpreted text role &quot;exc&quot;.</div>
<div class="system-message" id="system-message-3">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 3); <em><a href="#problematic-3">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="section" id="module-contents">
<h1>module contents</h1>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 9)</p>
<p>Unknown directive type &quot;py:currentmodule&quot;.</p>
<pre class="literal-block">
.. py:currentmodule:: predict
</pre>
</div>
<p class="drl-reactions rate-constants verbose-false">Upon creation of the DRL class object, it will convert the reaction equations to their respective rate equations.
When the model is given a set of initial concentrations, the rate equations can used to predict the concentration of
the system for the next time stamp (explicit Euler formula).</p>
<table class="drl-reactions rate-constants verbose-false docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">param reactions:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">The reactions that describe the system. Each tuple exist out of the name of the rate constant,
a list of reactants, and a list of products.</td>
</tr>
<tr class="field"><th class="field-name">type reactions:</th><td class="field-body">list[tuple[str, list[str], list[str]]]</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">param rate_constants:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">A dictionary which maps the rate constants to their respective values.</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">type rate_constants:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">dict[str: float]</td>
</tr>
<tr class="field"><th class="field-name">param verbose:</th><td class="field-body">If True, it will print and store information on which reactions are initialized.</td>
</tr>
<tr class="field"><th class="field-name">type verbose:</th><td class="field-body">bool</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">ivar reactions_overview:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">A comprehensive overview of the reactions that will be calculated
if the verbose argument was True upon initialization.</td>
</tr>
</tbody>
</table>
<div class="drl-reactions rate-constants verbose-false system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 28)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: predict_concentration(experimental_conditions, steps_per_step=1)

    Calls self._predict_concentration_slice to predict both the time before the addition, as the situation after the
    addition of the labeled compound. Inbetween the two prediction the concentration will be diluted according to
    the dilution factor, and the labeled chemical will be introduced in the system.

    :param experimental_conditions: The experimental conditions for which the prediction should be made.
    :type experimental_conditions: :class:`Experimental_Conditions`
    :param steps_per_step: The number of steps inbetween each step in the experimental_conditions.time array.
    :type steps_per_step: int
    :raise InvalidPredictionError: If negative concentration, or NaN values, are detected in the output.
    :return: Predictions of the concentrations pre-, and post-addition of the labeled compound.
        The chemicals might be in ordered in a different position.
    :rtype: tuple[polars.DataFrame, polars.DataFrame]
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 44)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: InvalidPredictionError

    Raised if negative or NaN values are detected in the output of the prediction.
    This can often be resolved by increasing the number of ``steps_per_step``.
    It also outputs the rate_constants which were given as an input.


</pre>
</div>
<p class="experimental-conditions-time initial-concentrations dilution-factor labeled-reactant">Stores basic information required for a prediction.</p>
<table class="experimental-conditions-time initial-concentrations dilution-factor labeled-reactant docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">param time:</th><td class="field-body">The time points at which a mass spectrum was measured, for both the unlabeled and the labeled sections.</td>
</tr>
<tr class="field"><th class="field-name">type time:</th><td class="field-body">tuple[np.ndarray, np.ndarray]</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">param initial_concentrations:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">The initial concentrations for each chemical. Only non-zero values must be given.</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">type initial_concentrations:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">dict[str, float]</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">param dilution_factor:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">The factor (&lt; 1) by which all concentration will be multiplied upon the addition of the labeled reactant.</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">type dilution_factor:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">float</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">param labeled_reactant:</th></tr>
<tr class="field"><td>&nbsp;</td><td class="field-body">The initial concentration for the labeled reactant. This will <strong>not</strong> be diluted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h1>examples</h1>
<p>The simple chemical system:</p>
<div class="formula">
<i>A</i><span class="unknown">\xrightarrow</span><span class="text">k1</span><i>B</i><span class="unknown">\xrightarrow</span><span class="text">k2</span><i>C</i>
</div>
<p>can be modeled using the <a href="#system-message-4"><span class="problematic" id="problematic-4">:class:`DRL &lt;predict.DRL&gt;`</span></a> class. First the reaction scheme should be written in a code
friendly way:</p>
<div class="system-message" id="system-message-4">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 71); <em><a href="#problematic-4">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<pre class="code python literal-block">
<span class="name">reaction1</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="literal string single">'k1'</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="literal string single">'A'</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal string single">'B'</span><span class="punctuation">])</span><span class="whitespace">
</span><span class="name">reaction2</span> <span class="operator">=</span> <span class="punctuation">(</span><span class="literal string single">'k2'</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="literal string single">'B'</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal string single">'C'</span><span class="punctuation">])</span><span class="whitespace">
</span><span class="name">reactions</span> <span class="operator">=</span> <span class="punctuation">[</span><span class="name">reaction1</span><span class="punctuation">,</span> <span class="name">reaction2</span><span class="punctuation">]</span>
</pre>
<p>Where the first element of each tuple is the name of the corresponding rate constant, the second element is a list
containing all reactants, and the third element is a list containing all the products. If for example B split into C and
byproduct D, we could write the reaction2 as <tt class="docutils literal">reaction2 = ('k2', <span class="pre">['B'],</span> ['C', <span class="pre">'D'])</span></tt></p>
<p>Lets assume that we know the rate constants belonging to this reaction.</p>
<pre class="code python literal-block">
<span class="name">rate_constants</span> <span class="operator">=</span> <span class="punctuation">{</span><span class="whitespace">
</span>    <span class="literal string double">&quot;k1&quot;</span><span class="punctuation">:</span> <span class="literal number float">0.2</span><span class="punctuation">,</span><span class="whitespace">
</span>    <span class="literal string double">&quot;k2&quot;</span><span class="punctuation">:</span> <span class="literal number float">0.5</span><span class="punctuation">,</span><span class="whitespace">
</span><span class="punctuation">}</span>
</pre>
<p>To create the relevant prediction for this model we need to collect the
<a href="#system-message-5"><span class="problematic" id="problematic-5">:class:`experimental data &lt;predict.Experimental_Conditions&gt;`</span></a> in a class. Some of the input variables contain non-sensible
information, this is because we currently do not want to model a complete DRL experiment, but only the simple beginning.
After this is done, the prediction can be made using <a href="#system-message-6"><span class="problematic" id="problematic-6">:func:`DRL.predict_concentration`</span></a>.</p>
<div class="system-message" id="system-message-5">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 93); <em><a href="#problematic-5">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="system-message-6">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 93); <em><a href="#problematic-6">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<pre class="code python literal-block">
<span class="keyword namespace">import</span> <span class="name namespace">numpy</span> <span class="keyword">as</span> <span class="name namespace">np</span><span class="whitespace">
</span><span class="keyword namespace">from</span> <span class="name namespace">delayed_reactant_labeling.predict</span> <span class="keyword namespace">import</span> <span class="name">DRL</span><span class="punctuation">,</span> <span class="name">Experimental_Conditions</span><span class="whitespace">

</span><span class="name">time_pre_addition</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">linspace</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">20</span><span class="punctuation">,</span> <span class="literal number integer">2000</span><span class="punctuation">)</span>  <span class="comment single"># 0 to 10 minutes, 2000 datapoints</span><span class="whitespace">
</span><span class="name">time_post_addition</span> <span class="operator">=</span> <span class="name">np</span><span class="operator">.</span><span class="name">linspace</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">)</span>    <span class="comment single"># filled with a useable time array, but we will ignore these results</span><span class="whitespace">
</span><span class="name">A0</span> <span class="operator">=</span> <span class="literal number integer">1</span><span class="whitespace">

</span><span class="name">experimental_conditions</span> <span class="operator">=</span> <span class="name">Experimental_Conditions</span><span class="punctuation">(</span><span class="whitespace">
</span>    <span class="name">time</span><span class="operator">=</span><span class="punctuation">(</span><span class="name">time_pre_addition</span><span class="punctuation">,</span> <span class="name">time_post_addition</span><span class="punctuation">,),</span><span class="whitespace">
</span>    <span class="name">initial_concentrations</span><span class="operator">=</span><span class="punctuation">{</span><span class="literal string single">'A'</span><span class="punctuation">:</span> <span class="name">A0</span><span class="punctuation">},</span><span class="whitespace">
</span>    <span class="name">dilution_factor</span><span class="operator">=</span><span class="literal number integer">1</span><span class="punctuation">,</span>                  <span class="comment single"># we do not model DRL here</span><span class="whitespace">
</span>    <span class="name">labeled_reactant</span><span class="operator">=</span><span class="punctuation">{}</span>                 <span class="comment single"># we do not model DRL here</span><span class="whitespace">
</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">drl</span> <span class="operator">=</span> <span class="name">DRL</span><span class="punctuation">(</span><span class="name">rate_constants</span><span class="operator">=</span><span class="name">rate_constants</span><span class="punctuation">,</span> <span class="name">reactions</span><span class="operator">=</span><span class="name">reactions</span><span class="punctuation">,</span> <span class="name">verbose</span><span class="operator">=</span><span class="keyword constant">False</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">pred</span><span class="punctuation">,</span> <span class="name">_</span> <span class="operator">=</span> <span class="name">drl</span><span class="operator">.</span><span class="name">predict_concentration</span><span class="punctuation">(</span><span class="name">experimental_conditions</span><span class="operator">=</span><span class="name">experimental_conditions</span><span class="punctuation">)</span>
</pre>
<p>However, also algebraic <a class="reference external" href="https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Mathematical_Methods_in_Chemistry_(Levitus)/04%3A_First_Order_Ordinary_Differential_Equations/4.03%3A_Chemical_Kinetics">solutions</a>
for this specific chemical problem exist.</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:/Users/mdingemans/delayed_reactant_labeling/docs/source/predict.rst</tt>, line 120)</p>
<p>Error in &quot;math&quot; directive:
unknown option: &quot;nowrap&quot;.</p>
<pre class="literal-block">
.. math::
   :nowrap:

    \begin{eqnarray}
    [A]_t = [A]_0 \cdot e^{-k_1t}
    \end{eqnarray}
    \begin{eqnarray}
    [B]_t = \frac{k_1}{k_2-k_1}[A]_0(e^{-k_1t}-e^{-k_2t})
    \end{eqnarray}
    \begin{eqnarray}
    [C]_t = A_0[1-e^{-k_1t}-\frac{k_1}{k_2-k_1}(e^{-k_1t}-e^{-k_2t})]
    \end{eqnarray}

</pre>
</div>
<p>We can compare the algebraic solution to the modelled prediction as follows.</p>
<pre class="code python literal-block">
<span class="keyword namespace">import</span> <span class="name namespace">matplotlib.pyplot</span> <span class="keyword">as</span> <span class="name namespace">plt</span><span class="whitespace">
</span><span class="name">time</span> <span class="operator">=</span> <span class="name">experimental_conditions</span><span class="operator">.</span><span class="name">time</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span><span class="whitespace">

</span><span class="name">fig</span><span class="punctuation">,</span> <span class="name">ax</span> <span class="operator">=</span> <span class="name">plt</span><span class="operator">.</span><span class="name">subplots</span><span class="punctuation">()</span><span class="whitespace">
</span><span class="name">ax</span><span class="operator">.</span><span class="name">plot</span><span class="punctuation">(</span><span class="name">time</span><span class="punctuation">,</span> <span class="name">pred</span><span class="punctuation">[</span><span class="literal string single">'A'</span><span class="punctuation">]</span> <span class="operator">/</span> <span class="name">A0</span><span class="punctuation">,</span> <span class="name">label</span><span class="operator">=</span><span class="literal string single">'A'</span><span class="punctuation">,</span> <span class="name">color</span><span class="operator">=</span><span class="literal string single">'C0'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">ax</span><span class="operator">.</span><span class="name">plot</span><span class="punctuation">(</span><span class="name">time</span><span class="punctuation">,</span> <span class="name">pred</span><span class="punctuation">[</span><span class="literal string single">'B'</span><span class="punctuation">]</span> <span class="operator">/</span> <span class="name">A0</span><span class="punctuation">,</span> <span class="name">label</span><span class="operator">=</span><span class="literal string single">'B'</span><span class="punctuation">,</span> <span class="name">color</span><span class="operator">=</span><span class="literal string single">'C1'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">ax</span><span class="operator">.</span><span class="name">plot</span><span class="punctuation">(</span><span class="name">time</span><span class="punctuation">,</span> <span class="name">pred</span><span class="punctuation">[</span><span class="literal string single">'C'</span><span class="punctuation">]</span> <span class="operator">/</span> <span class="name">A0</span><span class="punctuation">,</span> <span class="name">label</span><span class="operator">=</span><span class="literal string single">'C'</span><span class="punctuation">,</span> <span class="name">color</span><span class="operator">=</span><span class="literal string single">'C2'</span><span class="punctuation">)</span><span class="whitespace">

</span><span class="name">ax</span><span class="operator">.</span><span class="name">plot</span><span class="punctuation">(</span><span class="name">time</span><span class="punctuation">,</span> <span class="name">A0</span> <span class="operator">*</span> <span class="name">np</span><span class="operator">.</span><span class="name">exp</span><span class="punctuation">(</span><span class="operator">-</span><span class="name">k1</span> <span class="operator">*</span> <span class="name">time</span><span class="punctuation">),</span><span class="whitespace">
</span>    <span class="name">label</span><span class="operator">=</span><span class="literal string single">'A'</span><span class="punctuation">,</span> <span class="name">color</span><span class="operator">=</span><span class="literal string single">'C0'</span><span class="punctuation">,</span> <span class="name">linestyle</span><span class="operator">=</span><span class="literal string single">'--'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">ax</span><span class="operator">.</span><span class="name">plot</span><span class="punctuation">(</span><span class="name">time</span><span class="punctuation">,</span> <span class="name">k1</span> <span class="operator">/</span> <span class="punctuation">(</span><span class="name">k2</span> <span class="operator">-</span> <span class="name">k1</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="name">A0</span> <span class="operator">*</span> <span class="punctuation">(</span><span class="name">np</span><span class="operator">.</span><span class="name">exp</span><span class="punctuation">(</span><span class="operator">-</span><span class="name">k1</span> <span class="operator">*</span> <span class="name">time</span><span class="punctuation">)</span> <span class="operator">-</span> <span class="name">np</span><span class="operator">.</span><span class="name">exp</span><span class="punctuation">(</span><span class="operator">-</span><span class="name">k2</span> <span class="operator">*</span> <span class="name">time</span><span class="punctuation">)),</span><span class="whitespace">
</span>    <span class="name">label</span><span class="operator">=</span><span class="literal string single">'B'</span><span class="punctuation">,</span> <span class="name">color</span><span class="operator">=</span><span class="literal string single">'C1'</span><span class="punctuation">,</span> <span class="name">linestyle</span><span class="operator">=</span><span class="literal string single">'--'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">ax</span><span class="operator">.</span><span class="name">plot</span><span class="punctuation">(</span><span class="name">time</span><span class="punctuation">,</span> <span class="name">A0</span> <span class="operator">*</span> <span class="punctuation">(</span><span class="literal number integer">1</span> <span class="operator">-</span> <span class="name">np</span><span class="operator">.</span><span class="name">exp</span><span class="punctuation">(</span><span class="operator">-</span><span class="name">k1</span> <span class="operator">*</span> <span class="name">time</span><span class="punctuation">)</span> <span class="operator">-</span> <span class="name">k1</span> <span class="operator">/</span> <span class="punctuation">(</span><span class="name">k2</span> <span class="operator">-</span> <span class="name">k1</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="punctuation">(</span><span class="name">np</span><span class="operator">.</span><span class="name">exp</span><span class="punctuation">(</span><span class="operator">-</span><span class="name">k1</span> <span class="operator">*</span> <span class="name">time</span><span class="punctuation">)</span> <span class="operator">-</span> <span class="name">np</span><span class="operator">.</span><span class="name">exp</span><span class="punctuation">(</span><span class="operator">-</span><span class="name">k2</span> <span class="operator">*</span> <span class="name">time</span><span class="punctuation">))),</span><span class="whitespace">
</span>    <span class="name">label</span><span class="operator">=</span><span class="literal string single">'C'</span><span class="punctuation">,</span> <span class="name">color</span><span class="operator">=</span><span class="literal string single">'C2'</span><span class="punctuation">,</span> <span class="name">linestyle</span><span class="operator">=</span><span class="literal string single">'--'</span><span class="punctuation">)</span><span class="whitespace">
</span><span class="name">ax</span><span class="operator">.</span><span class="name">legend</span><span class="punctuation">()</span><span class="whitespace">
</span><span class="name">fig</span><span class="operator">.</span><span class="name">show</span><span class="punctuation">()</span>
</pre>
<img alt="images/predict_prediction.png" class="align-center" src="images/predict_prediction.png" style="width: 400px;" />
</div>
</div>
</body>
</html>
